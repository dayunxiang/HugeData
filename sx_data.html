<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>大数据平台</title>
    <link rel="stylesheet" href="css/layui.css">
    <link rel="stylesheet" href="css/data.css">
</head>
<body>
<div class="container">
    <!--上部-->
    <div class="top">
        <div class="top_left"><span>987654321</span></div><!--左上角数字-->
        <div class="top_right"><span>987654321</span></div><!--右上角数字-->
    </div>
    <!--中间部分-->
    <div class="center">
        <!--截止日期和成立时间等信息-->
        <div class="center_top">
            <div class="expiration"><span>统计截止日期：</span><span>2018-04-01</span></div>
            <div class="top_main">
                <table class="data">
                    <tr>
                        <td>成立时间</td>
                        <td>953</td>
                        <td>服务窗口</td>
                        <td>2001-2013</td>
                    </tr>
                    <tr>
                        <td>入厅面积</td>
                        <td>1578</td>
                        <td>大厅人员</td>
                        <td>43789</td>
                    </tr>
                    <tr>
                        <td>进驻单位</td>
                        <td>2.827116</td>
                        <td>年度办件总数</td>
                        <td>578</td>
                    </tr>
                </table>
            </div>
        </div>
        <div class="center_bottom">  <!--地图-->
            <div id="map"></div>
            <img src="sxImags/sc-center.png" height="47" width="52" id="centerCircle"/><p id="sx">沙溪建成区</p>
        </div>
    </div>
    <!--左半部-->
    <div class="left">
        <!--审批工作效能-->
        <div class="workEff">
            <h1 class="topic"><img src="sxImags/liststyle.png" class="listStyle"/><img src="sxImags/topic-02.png"/></h1>
            <ul>
                <li>
                    <img src="sxImags/icon01.png" class="effIcon"/>
                    <div class="effInfo">
                        <p class="rate">23.35%</p>
                        <p class="rateInfo">提前办结率</p>
                    </div>
                </li>
                <li>
                    <img src="sxImags/icon03.png" class="effIcon"/>
                    <div class="effInfo">
                        <p class="rate">9<span class="rateInfo small">/件</span></p>
                        <p class="rateInfo">超时办结</p>
                    </div>
                </li>
                <li>
                    <img src="sxImags/icon02.png" class="effIcon"/>
                    <div class="effInfo">
                        <p class="rate">95.35%</p>
                        <p class="rateInfo">按时办结率</p>
                    </div>
                </li>
                <li>
                    <img src="sxImags/icon04.png" class="effIcon"/>
                    <div class="effInfo small">
                        <p class="rate">42<span class="rateInfo small">/件</span></p>
                        <p class="rateInfo">超时预警</p>
                    </div>
                </li>
            </ul>
        </div>
        <!--办件动态-->
        <div class="workTrends">
            <h1 class="topic"><img src="sxImags/liststyle.png" class="listStyle"/><img src="sxImags/topic-03.png"/></h1>
            <table class="trends">
                <tr><td> </td><td>申办主体</td><td>受理部门</td><td>受理事项</td><td>申报日期</td></tr>
                <tr><td>1</td><td>张云秀</td><td>省教育厅</td><td>本村人员户籍迁移证明</td><td>2018-03-01</td></tr>
                <tr><td>2</td><td>李泽林</td><td>省教育厅</td><td>本村人员户籍迁移证明</td><td>2018-03-01</td></tr>
                <tr><td>3</td><td>王庆群</td><td>省教育厅</td><td>本村人员户籍迁移证明</td><td>2018-03-01</td></tr>
                <tr><td>4</td><td>张云秀</td><td>省教育厅</td><td>本村人员户籍迁移证明</td><td>2018-03-01</td></tr>
                <tr><td>5</td><td>李泽林</td><td>省教育厅</td><td>本村人员户籍迁移证明</td><td>2018-03-01</td></tr>
                <tr><td>6</td><td>王庆群</td><td>省教育厅</td><td>本村人员户籍迁移证明</td><td>2018-03-01</td></tr>
            </table>
        </div>
        <!--进驻部门业务办理情况-->
        <div class="situation">
            <h1 class="topic"><img src="sxImags/liststyle.png" class="listStyle"/><span class="title">进驻部门业务办理情况</span></h1>
            <div id="offCase" style="width: 640px;height: 300px;"></div>
        </div>
    </div>
    <!--右半部-->
    <div class="right">
        <!--业务办理情况汇总-->
        <div class="workHandle">
            <h1 class="topic"><img src="sxImags/liststyle.png" class="listStyle"/><img src="sxImags/topic-04.png"/></h1>
            <ul>
                <li class="handle_main">
                    <p class="handle_num textGreen">1212</p>
                    <p class="handle_info">本周累计办理</p>
                </li>
                <li class="handle_main">
                    <p class="handle_num textYellow">4122</p>
                    <p class="handle_info">本月累计办理</p>
                </li>
                <li class="handle_main">
                    <p class="handle_num textBlue">63197</p>
                    <p class="handle_info">本年度累计办理</p>
                </li>
            </ul>
        </div>
        <!--业务办理情况Top5-->
        <div class="workTop">
            <h1 class="topic"><img src="sxImags/liststyle.png" class="listStyle"/><img src="sxImags/topic-05.png"/></h1>
        <ul>
            <li class="topItem">
                <span class="topText">TOP01</span>
                <div class="layui-progress">
                    <div class="layui-progress-bar graBg-purple" lay-percent="65%">
                        <span class="layui-progress-text workName"> 建筑设计方案节能审查</span>
                    </div>
                </div>
            </li>
            <li class="topItem">
                <span class="topText">TOP02</span>
                <div class="layui-progress">
                    <div class="layui-progress-bar graBg-purple" lay-percent="45%">
                        <span class="layui-progress-text workName"> 建筑设计方案审定意见</span>
                    </div>
                </div>
            </li>
            <li class="topItem">
                <span class="topText">TOP03</span>
                <div class="layui-progress">
                    <div class="layui-progress-bar graBg-purple" lay-percent="35%">
                        <span class="layui-progress-text workName">市政基础设施拆除开挖备案</span>
                    </div>
                </div>
            </li>
            <li class="topItem">
                <span class="topText">TOP04</span>
                <div class="layui-progress">
                    <div class="layui-progress-bar graBg-purple" lay-percent="30%">
                        <span class="layui-progress-text workName">建设工程施工图审查初审</span>
                    </div>
                </div>
            </li>
            <li class="topItem">
                <span class="topText">TOP05</span>
                <div class="layui-progress">
                    <div class="layui-progress-bar graBg-purple" lay-percent="25%">
                        <span class="layui-progress-text workName">省外勘察设计单位进市承接单项工程资质核验单项</span>
                    </div>
                </div>
            </li>
        </ul>
    </div>
        <!--业务平均办理时限统计-->
        <div class="limitTime">
            <h1 class="topic"><img src="sxImags/liststyle.png" class="listStyle"/><img src="sxImags/topic-06.png"/></h1>
            <div id="3dBar" style="width:275px;height: 453px;margin-top: 25px;margin-left: 73px"></div>
            <p class="timeTop">10</p><p class="topLine"></p><p class="topMsg">服务事项法定承诺时限</p><!--timeTop:柱体上的时间；topLine:柱体两侧的竖线；topMsg:柱体两侧文本-->
            <p class="timeMiddle">7</p><p class="middleLine"></p><p class="middleMsg">业务平均承诺时限</p>
            <p class="timeBottom">5</p><p class="bottomLine"></p><p class="bottomMsg">业务平均办理时限</p>
        </div>
    </div>
</div>
<script src="js/jquery-3.2.1.min.js"></script>
<script src="js/layui.all.js"></script>
<script src="js/echarts.min.js"></script>
<script src="js/echarts-gl.min.js"></script>
<script>
    $(function () {
        var workName=document.getElementsByClassName('workName');  /* 业务Top5文字定位*/
        var leftSpan=$(".top_left span");           /*左上角数字*/
        var rightSpan=$(".top_right span");         /*右上角数字*/
        var tds=$(".data tr td:nth-child(2n)");    /*列表数字*/
        var handleNum=$(".handle_main .handle_num");/*业务汇总数字*/
        var offCase=echarts.init(document.getElementById("offCase"));  /*进驻部门业务办理情况*/
        var limitTime=echarts.init(document.getElementById("3dBar")); /*3d柱状图*/
        var map=echarts.init(document.getElementById('map'));         /*地图*/
        var i;
        /*进驻部门办理情况*/
        var dataAxis=["区国税局","区教育局","区城管局","区商务局","区安监局","区财政局","区司法局"];
        var data=[400000,670000,480000,780000,300000,360000,500000];
        var caseOption={
            tooltip:{
                trigger:'axis'
            },
            grid:{
                containLabel:true,/*包含xy轴文字*/
                top:5,             /*设置整体位置*/
                left:'left',
                bottom:0,
                right:0
            },
            xAxis:{
                data:dataAxis,
                axisLabel:{
                    textStyle:{           /* x轴文字样式 */
                        color:'rgb(255,255,255,0.5)'
                    }
                    // rotate:30
                },
                axisLine:{                  /*x轴轴线样式*/
                    lineStyle:{color:'rgb(12,43,90,0.5)'}
                },
                axisTick:{show:false},       /*不显示刻度*/
                axisPointer:{type:'shadow'}
            },
            yAxis:{
                axisLabel:{color:'#60adfd',fontSize:12}, /*y文字颜色*/
                axisLine:{                  /*y轴轴线样式*/
                    lineStyle:{color:'rgb(12,43,90,0.5)'}
                },
                splitLine:{                 /*y轴分割线设置*/
                    lineStyle:{color:'rgb(12,43,90,0.5)'}
                }
            },
            series:[
                {
                    type: 'bar',
                    barGap: '-100%',
                    barWidth:10,
                    data: data,
                    itemStyle: {
                        normal: {
                            /*设置柱形颜色*/
                            color: new echarts.graphic.LinearGradient(0, 0, 0, 1,
                                [{offset: 0, color: '#1ca5ff'}, {offset: 1, color: '#0065ef'}]
                            ),
                            barBorderRadius:[5,5,0,0]
                        }
                    }
                }]
        };
        offCase.setOption(caseOption);
        /*地图*/
        var geoCoordMap = {   /*各坐标位置*/
            '沙溪建成区': [109.9865,28.0465],
            '香塘村': [123.9051,49.7539],
            '渠泾村': [113.6551,47.5539],
            '归庄建成区': [112.9551,43.0539],
            '庄西村': [107.5551,40.0539],
            '项桥村': [100.3467,38.0899],
            '虹桥村': [88.3467,31.0899],
            '泰西村': [94.7865,26.1465],
            '泥桥村': [81.5467,22.5899],
            '直塘建成区': [88.6467,21.6899],
            '泰东村': [101.3865,27.1465],
            '洪泾村': [103.0865,29.7465],
            '半泾村': [105.7865,23.8465],
            '中荷村': [114.5107,21.6196],
            '胜利村': [125.9046,26.0633],
            '松南村': [132.4046,30.0633],
            '涂松村': [123.2229,34.4409],
            '印北村': [111.6229,32.8409],
            '凡山村': [123.5154,41.2584],
            '岳星村': [146.5046,28.5633],
            '太星村': [155.0046,32.5633],
            '新建村': [156.9648,27.5891],
            '岳王建成区': [151.0648,22.0891],
            '岳镇村': [147.3648,18.5891],
            '塘桥村': [139.3648,22.0891]
        };
        var SXData = [     /*终点圆圈大小*/
            [{name:'沙溪建成区'}, {name:'香塘村',value:95}],
            [{name:'沙溪建成区'}, {name:'渠泾村',value:95}],
            [{name:'沙溪建成区'}, {name:'归庄建成区',value:95}],
            [{name:'沙溪建成区'}, {name:'庄西村',value:95}],
            [{name:'沙溪建成区'}, {name:'项桥村',value:95}],
            [{name:'沙溪建成区'}, {name:'虹桥村',value:95}],
            [{name:'沙溪建成区'}, {name:'泰西村',value:50}],
            [{name:'沙溪建成区'}, {name:'泥桥村',value:50}],
            [{name:'沙溪建成区'}, {name:'直塘建成区',value:50}],
            [{name:'沙溪建成区'}, {name:'泰东村',value:50}],
            [{name:'沙溪建成区'}, {name:'洪泾村',value:50}],
            [{name:'沙溪建成区'}, {name:'半泾村',value:50}],
            [{name:'沙溪建成区'}, {name:'中荷村',value:90}],
            [{name:'沙溪建成区'}, {name:'胜利村',value:60}],
            [{name:'沙溪建成区'}, {name:'松南村',value:60}],
            [{name:'沙溪建成区'}, {name:'涂松村',value:80}],
            [{name:'沙溪建成区'}, {name:'印北村',value:80}],
            [{name:'沙溪建成区'}, {name:'凡山村',value:40}],
            [{name:'沙溪建成区'}, {name:'岳星村',value:40}],
            [{name:'沙溪建成区'}, {name:'太星村',value:40}],
            [{name:'沙溪建成区'}, {name:'新建村',value:95}],
            [{name:'沙溪建成区'}, {name:'岳王建成区',value:95}],
            [{name:'沙溪建成区'}, {name:'岳镇村',value:95}],
            [{name:'沙溪建成区'}, {name:'塘桥村',value:95}]
        ];
        var convertData = function (data) {  /*起点终点位置坐标*/
            var res = [];
            for (var i = 0; i < data.length; i++) {
                var dataItem = data[i];
                var fromCoord = geoCoordMap[dataItem[0].name];
                var toCoord = geoCoordMap[dataItem[1].name];
                if (fromCoord && toCoord) {
                    res.push({
                        fromName: dataItem[0].name,
                        toName: dataItem[1].name,
                        coords: [fromCoord, toCoord]
                    });
                }
            }
            return res;
        };
        var mapOption={
            backgroundColor: 'transparent',
            geo: {
                map: 'china',
                layoutCenter: ['60%', '60%'],/*调整大小*/
                layoutSize: 100,
                itemStyle: {   /*隐藏原有地图*/
                    normal: {
                        areaColor: 'transparent',
                        borderColor: 'transparent'
                    },
                    emphasis: {
                        areaColor: 'transparent',
                        borderColor: 'transparent'
                    }
                }
            },
            series:  [{
                type: 'lines',
                zlevel: 1,
                effect: {     /*设置白尾巴*/
                    show: true,
                    period: 6,
                    trailLength: 0.7,
                    color: '#fff',
                    symbolSize: 3
                },
                lineStyle: {
                    normal: {
                        color: '#a6c84c',
                        width: 0,
                        curveness: 0.2
                    }
                },
                data: convertData(SXData)
            },
                {
                    type: 'lines',
                    zlevel: 2,
                    effect: {
                        show: true,
                        period: 6,        /*特效持续时间*/
                        trailLength: 0,   /*特效尾迹长度*/
                        symbol: 'pin',
                        symbolSize: 15    /*标记大小*/
                    },
                    lineStyle: {        /*线样式*/
                        normal: {
                            color: '#a6c84c',
                            width: 1,
                            opacity: 1,
                            curveness: 0.2
                        }
                    },
                    data: convertData(SXData)
                },
                {
                    type: 'effectScatter',         /*带有涟漪动画的气泡图*/
                    coordinateSystem: 'geo',       /*使用地理坐标系*/
                    zlevel: 2,
                    rippleEffect: {
                        brushType: 'stroke'       /*波纹绘制方式*/
                    },
                    label: {
                        normal: {
                            show: true,
                            position: 'top',
                            formatter: '{b}',
                            color:'#fff',
                            fontSize:12
                        }
                    },
                    itemStyle: {                 /*图形的颜色*/
                        normal: {
                            type:'radial',
                            color:'#fff',
                            borderWidth:1,
                            borderType:'solid',
                            borderColor:'#fff100'
                        }
                    },
                    data: SXData.map(function (dataItem) {
                        return {
                            name: dataItem[1].name,
                            value: geoCoordMap[dataItem[1].name].concat([dataItem[1].value])
                        };
                    })
                }]
        };
        /*时限统计*/
        var hours = ['12a', '1a', '2a', '3a', '4a', '5a'];
        var days = ['Saturday', 'Friday', 'Thursday'];
        var limitOption={
            xAxis3D: {
                data: hours
            },
            yAxis3D: {
                data: days
            },
            zAxis3D: {},
            grid3D: {
                show: false,
                boxWidth:200,
                boxHeight:169,
                boxDepth: 110,
                viewControl: {
                    rotateSensitivity:0,  /*鼠标不旋转*/
                    zoomSensitivity:0,     /*鼠标不能放大缩小*/
                    beta:60,               /*左右旋转角度*/
                    alpha:10               /*旋转*/
                }
            },
            series: [{
                type: 'bar3D',
                data: [{value: [2, 1, 5], itemStyle: {color: "#1476f1"}}],  /*最下面块，0、3不动,最后的数据代表长度*/
                shading: 'lambert',/*着色效果*/
                stack: 'stack',/*着堆叠效果*/
                silent:true,   /*不触发鼠标事件*/
                label:{show:true}

            },
                {
                    type: 'bar3D',
                    data: [{value: [2, 1, 2], itemStyle: {color: "#f9cb00"}}], /*向上叠加，中间块*/
                    shading: 'lambert',
                    stack: 'stack',
                    silent:true
                },
                {
                    type: 'bar3D',
                    data: [{value: [2, 1, 3], itemStyle: {color: "#818fa5"}}], /*上面块*/
                    shading: 'lambert',
                    stack: 'stack',
                    silent:true
                }
            ]
        };

        limitTime.setOption(limitOption);
        map.setOption(mapOption);
        /*业务办理文字定位*/
        for(i=0;i<workName.length;i++){
            workName[i].style.right=(-(workName[i].clientWidth+7))+"px";
        }
        /*数字加逗号*/
        leftSpan.html(parseFloat(leftSpan.html()).toLocaleString());
        rightSpan.html(parseFloat(rightSpan.html()).toLocaleString());
        $.each(tds,function (i,item) {
           $(this).text(parseFloat($(this).text()).toLocaleString());
        });
        handleNum.html(parseFloat(handleNum.html()).toLocaleString());
    })
</script>
</body>
</html>